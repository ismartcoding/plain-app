import{d as Ve,ah as Ce,p as Te,r as b,u as Ie,s as Se,a as Re,A as Ee,D as P,n as ze,B as Ae,C as De,ai as Fe,af as Y,aj as Ue,E as Me,t as qe,ak as Be,an as Ne,H as Z,I as Le,J as xe,o as l,c as u,b as e,e as d,g as o,F as g,w as r,k as _,R as A,f as a,v as Ke,K as D,L as Qe,M as Oe,y as F,X as ee,N as te,O as Ge,x as He,l as Xe,z as oe,S as se,aa as We,am as je,a2 as Je,a3 as Pe,_ as Ye}from"./index-71bc54e4.js";import{u as Ze,_ as et,a as tt}from"./list-356efb39.js";import{_ as ot}from"./FieldId-5e4e1706.js";import{_ as st}from"./Multiselect-390a6b3e.js";import{_ as nt,a as lt}from"./grid-view-outline-rounded-88cd6c98.js";import{_ as at,a as it}from"./label-outline-rounded-2663147f.js";import{a as ut,_ as ct}from"./files-b279a28c.js";import{_ as dt}from"./delete-outline-rounded-d0e9e9e7.js";import{_ as rt}from"./Breadcrumb-9e507271.js";import{n as ne}from"./list-6498ebd9.js";import{b as _t,a as pt}from"./search-cd166c4f.js";import{u as mt,a as vt,b as bt}from"./tags-bbc0b0f2.js";import{u as ht,_ as ft}from"./ConfirmModal.vuevuetypescriptsetuptruelang-d42f5501.js";import"./VModal.vuevuetypescriptsetuptruelang-1499a382.js";import"./baseIndexOf-70b929c6.js";import"./toInteger-357e9f33.js";import"./vee-validate.esm-b28bbd9f.js";const le=y=>(Je("data-v-a2ffd617"),y=y(),Pe(),y),gt={class:"v-toolbar"},yt={class:"right-actions"},kt=["title"],wt=["title"],$t=["title"],Vt=["title"],Ct=["onClick"],Tt=["onClick"],It={class:"row mb-3"},St={class:"col-md-3 col-form-label"},Rt={class:"col-md-9"},Et=["onKeyup"],zt={class:"row mb-3"},At={class:"col-md-3 col-form-label"},Dt={class:"col-md-9"},Ft={class:"actions"},Ut=["onClick"],Mt={key:0,class:"row row-cols-6 g-1",style:{"margin-bottom":"24px"}},qt=["onClick"],Bt=["src"],Nt={class:"duration"},Lt={key:1,class:"no-data-placeholder"},xt={key:2,class:"table"},Kt=le(()=>e("th",null,"ID",-1)),Qt=le(()=>e("th",null,null,-1)),Ot=["onClick"],Gt=["onUpdate:modelValue"],Ht=["src","onClick"],Xt={class:"badge"},Wt={key:0},jt={colspan:"7"},Jt={class:"no-data-placeholder"},Pt=Ve({__name:"VideosView",setup(y){var W,j,J;const ae=Ce(),U=Te(),c=b([]),{t:M}=Ie(),{app:C}=Se(Re()),p=Ee({text:"",tags:[]}),ie=P(()=>c.value.some(s=>s.checked)),h="VIDEO",T=ze().query,f=b(parseInt(((W=T.page)==null?void 0:W.toString())??"1")),k=54,w=b(0),m=b(Ae(((j=T.q)==null?void 0:j.toString())??"")),q=b(""),{tags:I}=mt(h,m,p,async s=>{q.value=_t(s),await De(),re()}),i=b(((J=T.view)==null?void 0:J.toString())??"grid"),{visible:ue,index:ce,view:B,hide:de}=Fe(),{addToTags:N}=vt(h,c,I),{removeFromTags:L}=bt(h,c,I),{deleteItems:x}=ht(h,c),{downloadItems:K}=ut(c,"videos.zip"),S=P(()=>c.value.map(s=>({src:Y(s.fileId),name:Ue(s.path),duration:s.duration,size:s.size}))),{selectAll:R,toggleSelect:Q}=Ze(c),{loading:O,load:re,refetch:_e}=Me({handle:async(s,n)=>{if(n)qe(M(n),"error");else if(s){const{fileIdToken:E}=C.value,$=[];for(const V of s.videos)$.push({...V,checked:!1,fileId:await Be(E,V.path)});c.value=$,w.value=s.videoCount}},document:Ne,variables:()=>({offset:(f.value-1)*k,limit:k,query:q.value}),appApi:!0});function G(){oe(U,`/videos?page=${f.value}&q=${se(m.value)}&view=${i.value}`)}Z(f,()=>{G()}),Z(i,()=>{G()});function H(){m.value=pt(p),X()}function X(){oe(U,`/videos?q=${se(m.value)}&view=${i.value}`)}function pe(){i.value==="grid"?i.value="list":i.value="grid"}function me(){ae.push("/files"),We(ft,{message:M("upload_videos")})}return Le(()=>{xe.on("refetch_by_tag_type",s=>{s===h&&_e()})}),(s,n)=>{const E=rt,$=dt,V=ct,ve=at,be=it,he=nt,fe=lt,ge=st,ye=et,ke=ot,we=tt,$e=je;return l(),u(g,null,[e("div",gt,[d(E,{current:()=>`${s.$t("page_title.videos")} (${w.value})`},null,8,["current"]),e("div",yt,[o(ie)&&i.value==="list"?(l(),u(g,{key:0},[e("button",{type:"button",class:"btn btn-action",onClick:n[0]||(n[0]=r((...t)=>o(x)&&o(x)(...t),["stop"])),title:s.$t("delete")},[d($,{class:"bi"})],8,kt),e("button",{type:"button",class:"btn btn-action",onClick:n[1]||(n[1]=r((...t)=>o(K)&&o(K)(...t),["stop"])),title:s.$t("download")},[d(V,{class:"bi"})],8,wt),e("button",{type:"button",class:"btn btn-action",onClick:n[2]||(n[2]=r((...t)=>o(N)&&o(N)(...t),["stop"])),title:s.$t("add_to_tags")},[d(ve,{class:"bi"})],8,$t),e("button",{type:"button",class:"btn btn-action",onClick:n[3]||(n[3]=r((...t)=>o(L)&&o(L)(...t),["stop"])),title:s.$t("remove_from_tags")},[d(be,{class:"bi"})],8,Vt)],64)):_("",!0),e("button",{type:"button",class:"btn btn-action",onClick:r(pe,["prevent"])},[i.value==="list"?(l(),A(he,{key:0,class:"bi"})):_("",!0),i.value==="grid"?(l(),A(fe,{key:1,class:"bi"})):_("",!0)],8,Ct),e("button",{type:"button",class:"btn btn-action",onClick:r(me,["prevent"])},a(s.$t("upload")),9,Tt),d(ye,{modelValue:m.value,"onUpdate:modelValue":n[6]||(n[6]=t=>m.value=t),search:X},{filters:Ke(()=>[e("div",It,[e("label",St,a(s.$t("keywords")),1),e("div",Rt,[D(e("input",{type:"text","onUpdate:modelValue":n[4]||(n[4]=t=>p.text=t),class:"form-control",onKeyup:Oe(H,["enter"])},null,40,Et),[[Qe,p.text]])])]),e("div",zt,[e("label",At,a(s.$t("tags")),1),e("div",Dt,[d(ge,{modelValue:p.tags,"onUpdate:modelValue":n[5]||(n[5]=t=>p.tags=t),label:"name","track-by":"id",options:o(I)},null,8,["modelValue","options"])])]),e("div",Ft,[e("button",{type:"button",class:"btn",onClick:r(H,["stop"])},a(s.$t("search")),9,Ut)])]),_:1},8,["modelValue"])])]),i.value==="grid"?(l(),u("div",Mt,[(l(!0),u(g,null,F(o(S),(t,z)=>(l(),u("div",{class:"col",onClick:v=>o(B)(z)},[e("img",{class:"image",src:t.src+"&w=200&h=200"},null,8,Bt),e("span",Nt,a(o(ee)(t.duration)),1)],8,qt))),256))])):_("",!0),i.value==="grid"&&o(S).length===0?(l(),u("div",Lt,a(s.$t(o(ne)(o(O),o(C).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):_("",!0),i.value==="list"?(l(),u("table",xt,[e("thead",null,[e("tr",null,[e("th",null,[D(e("input",{class:"form-check-input",type:"checkbox",onChange:n[7]||(n[7]=(...t)=>o(Q)&&o(Q)(...t)),"onUpdate:modelValue":n[8]||(n[8]=t=>Ge(R)?R.value=t:null)},null,544),[[te,o(R)]])]),Kt,Qt,e("th",null,a(s.$t("name")),1),e("th",null,a(s.$t("tags")),1),e("th",null,a(s.$t("duration")),1),e("th",null,a(s.$t("file_size")),1)])]),e("tbody",null,[(l(!0),u(g,null,F(c.value,(t,z)=>(l(),u("tr",{key:t.id,class:He({checked:t.checked}),onClick:r(v=>t.checked=!t.checked,["stop"])},[e("td",null,[D(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":v=>t.checked=v},null,8,Gt),[[te,t.checked]])]),e("td",null,[d(ke,{id:t.id,raw:t},null,8,["id","raw"])]),e("td",null,[e("img",{class:"img-video",src:o(Y)(t.fileId)+"&w=200&h=200",width:"50",height:"50",onClick:r(v=>o(B)(z),["stop"])},null,8,Ht)]),e("td",null,a(t.title),1),e("td",null,[(l(!0),u(g,null,F(t.tags,v=>(l(),u("span",Xt,a(v.name),1))),256))]),e("td",null,a(o(ee)(t.duration)),1),e("td",null,a(o(Xe)(t.size)),1)],10,Ot))),128))]),c.value.length?_("",!0):(l(),u("tfoot",Wt,[e("tr",null,[e("td",jt,[e("div",Jt,a(s.$t(o(ne)(o(O),o(C).permissions,"WRITE_EXTERNAL_STORAGE"))),1)])])]))])):_("",!0),w.value>k?(l(),A(we,{key:3,modelValue:f.value,"onUpdate:modelValue":n[9]||(n[9]=t=>f.value=t),total:w.value,limit:k},null,8,["modelValue","total"])):_("",!0),d($e,{visible:o(ue),index:o(ce),sources:o(S),onHide:o(de)},null,8,["visible","index","sources","onHide"])],64)}}});const ho=Ye(Pt,[["__scopeId","data-v-a2ffd617"]]);export{ho as default};
