import{b as ot,u as st,_ as nt,a as at}from"./list-c221660b.js";import{_ as lt}from"./FieldId-a909509e.js";import{_ as it}from"./Multiselect-7a4215db.js";import{_ as ct,a as ut}from"./label-outline-rounded-4577b874.js";import{_ as rt}from"./delete-outline-rounded-f07255a4.js";import{_ as dt}from"./Breadcrumb-cc2ecefa.js";import{d as _t,p as pt,r as m,u as mt,A as ht,n as bt,B as ft,C as vt,aL as gt,D as kt,E as yt,t as Ct,aM as $t,H as wt,I as Vt,J as Tt,o as i,c,b as t,e as u,g as n,F as g,w as r,k as $,f as a,v as At,K as w,L as St,M as Dt,N as F,O as It,y as K,x as qt,Q as N,R as Bt,z as R,S as z,aN as E}from"./index-5f2856f5.js";import{b as Mt,a as Qt}from"./search-82c31951.js";import{n as Ut}from"./list-6498ebd9.js";import{u as Lt,a as Ft,b as Kt}from"./tags-a0407254.js";import{t as Nt}from"./truncate-19bf33f0.js";import"./VModal.vuevuetypescriptsetuptruelang-1b277c9f.js";import"./baseIndexOf-70b929c6.js";import"./vee-validate.esm-b3cf4904.js";import"./stringToArray-31fa9dcc.js";import"./toInteger-c333620b.js";const Rt={class:"v-toolbar"},zt={class:"right-actions"},Et=["title"],Gt=["title"],Ht=["title"],Pt=["onClick"],Jt={class:"row mb-3"},Ot={class:"col-md-3 col-form-label"},jt={class:"col-md-9"},xt=["onKeyup"],Wt={class:"row mb-3"},Xt={class:"col-md-3 col-form-label"},Yt={class:"col-md-9"},Zt={class:"actions"},te=["onClick"],ee={class:"table"},oe=t("th",null,"ID",-1),se=["onClick"],ne=["onUpdate:modelValue"],ae=["onClick"],le={class:"badge"},ie={class:"nowrap"},ce={class:"nowrap"},ue={key:0},re={colspan:"6"},de={class:"no-data-placeholder"},Ie=_t({__name:"AIChatsView",setup(_e){var U,L;const V=pt(),l=m([]),{t:G}=mt(),d=ht({text:"",tags:[]}),h="AI_CHAT",T=bt().query,b=m(parseInt(((U=T.page)==null?void 0:U.toString())??"1")),f=50,v=m(0),_=m(ft(((L=T.q)==null?void 0:L.toString())??"")),A=m(""),{tags:k}=Lt(h,_,d,async o=>{o.push({name:"parent_id",op:"",value:""}),A.value=Mt(o),await vt(),J()}),{addToTags:S}=Ft(h,l,k),{removeFromTags:D}=Kt(h,l,k),{deleteItems:I}=ot(gt,()=>{B()},l),H=kt(()=>l.value.some(o=>o.checked)),{selectAll:y,toggleSelect:q}=st(l),{loading:P,load:J,refetch:B}=yt({handle:(o,s)=>{s?Ct(G(s),"error"):o&&(l.value=o.aiChats.map(C=>({...C,checked:!1})),v.value=o.aiChatCount)},document:$t,variables:()=>({offset:(b.value-1)*f,limit:f,query:A.value}),appApi:!0});wt(b,o=>{R(V,`/aichats?page=${o}&q=${z(_.value)}`)});function M(){_.value=Qt(d),Q()}function Q(){R(V,`/aichats?q=${z(_.value)}`)}Vt(()=>{Tt.on("refetch_by_tag_type",o=>{o===h&&B()})});function O(o){E(`/aichats/${o.id}`)}function j(){E("/aichats/create")}return(o,s)=>{const C=dt,x=rt,W=ct,X=ut,Y=it,Z=nt,tt=lt,et=at;return i(),c(g,null,[t("div",Rt,[u(C,{current:()=>`${o.$t("page_title.aichats")} (${v.value})`},null,8,["current"]),t("div",zt,[n(H)?(i(),c(g,{key:0},[t("button",{type:"button",class:"btn btn-action",onClick:s[0]||(s[0]=r((...e)=>n(I)&&n(I)(...e),["stop"])),title:o.$t("delete")},[u(x,{class:"bi"})],8,Et),t("button",{type:"button",class:"btn btn-action",onClick:s[1]||(s[1]=r((...e)=>n(S)&&n(S)(...e),["stop"])),title:o.$t("add_to_tags")},[u(W,{class:"bi"})],8,Gt),t("button",{type:"button",class:"btn btn-action",onClick:s[2]||(s[2]=r((...e)=>n(D)&&n(D)(...e),["stop"])),title:o.$t("remove_from_tags")},[u(X,{class:"bi"})],8,Ht)],64)):$("",!0),t("button",{class:"btn btn-action",type:"button",onClick:r(j,["prevent"])},a(o.$t("new_chat")),9,Pt),u(Z,{modelValue:_.value,"onUpdate:modelValue":s[5]||(s[5]=e=>_.value=e),search:Q},{filters:At(()=>[t("div",Jt,[t("label",Ot,a(o.$t("keywords")),1),t("div",jt,[w(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=e=>d.text=e),class:"form-control",onKeyup:Dt(M,["enter"])},null,40,xt),[[St,d.text]])])]),t("div",Wt,[t("label",Xt,a(o.$t("tags")),1),t("div",Yt,[u(Y,{modelValue:d.tags,"onUpdate:modelValue":s[4]||(s[4]=e=>d.tags=e),label:"name","track-by":"id",options:n(k)},null,8,["modelValue","options"])])]),t("div",Zt,[t("button",{type:"button",class:"btn",onClick:r(M,["stop"])},a(o.$t("search")),9,te)])]),_:1},8,["modelValue"])])]),t("table",ee,[t("thead",null,[t("tr",null,[t("th",null,[w(t("input",{class:"form-check-input",type:"checkbox",onChange:s[6]||(s[6]=(...e)=>n(q)&&n(q)(...e)),"onUpdate:modelValue":s[7]||(s[7]=e=>It(y)?y.value=e:null)},null,544),[[F,n(y)]])]),oe,t("th",null,a(o.$t("content")),1),t("th",null,a(o.$t("tags")),1),t("th",null,a(o.$t("updated_at")),1),t("th",null,a(o.$t("created_at")),1)])]),t("tbody",null,[(i(!0),c(g,null,K(l.value,e=>(i(),c("tr",{key:e.id,class:qt({checked:e.checked}),onClick:r(p=>e.checked=!e.checked,["stop"])},[t("td",null,[w(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>e.checked=p},null,8,ne),[[F,e.checked]])]),t("td",null,[u(tt,{id:e.id,raw:e},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:r(p=>O(e),["stop"])},a(n(Nt)(e.content,{length:200,omission:""})),9,ae)]),t("td",null,[(i(!0),c(g,null,K(e.tags,p=>(i(),c("span",le,a(p.name),1))),256))]),t("td",ie,a(n(N)(e.updatedAt)),1),t("td",ce,a(n(N)(e.createdAt)),1)],10,se))),128))]),l.value.length?$("",!0):(i(),c("tfoot",ue,[t("tr",null,[t("td",re,[t("div",de,a(o.$t(n(Ut)(n(P)))),1)])])]))]),v.value>f?(i(),Bt(et,{key:0,modelValue:b.value,"onUpdate:modelValue":s[8]||(s[8]=e=>b.value=e),total:v.value,limit:f},null,8,["modelValue","total"])):$("",!0)],64)}}});export{Ie as default};
